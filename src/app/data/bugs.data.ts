import { BugInfo } from '../models/bug-info.model';

/**
 * 10 new unique bugs for agent maturity testing.
 * Each error type and location is different.
 */
export const KNOWN_BUGS: BugInfo[] = [
  {
    id: 'bug-1',
    title: 'Bug 1: utils/ — substring on null',
    description: 'truncate in string-utils — str.substring when str is null.',
    errorMessage: "TypeError: Cannot read properties of null (reading 'substring')",
    file: 'src/app/utils/string-utils.ts',
    line: 3,
    fixSuggestion: 'return str?.substring(0, maxLen) ?? ""',
    triggerLabel: 'Bug 1',
  },
  {
    id: 'bug-2',
    title: 'Bug 2: utils/ — Object.entries on null',
    description: 'pickKeys in object-utils — Object.entries(null) throws.',
    errorMessage: 'TypeError: Cannot convert undefined or null to object',
    file: 'src/app/utils/object-utils.ts',
    line: 3,
    fixSuggestion: 'if (!obj) return []; return Object.entries(obj).map(...)',
    triggerLabel: 'Bug 2',
  },
  {
    id: 'bug-3',
    title: 'Bug 3: services/ — property on null',
    description: 'ApiService.getStatus — response.status when response null.',
    errorMessage: "TypeError: Cannot read properties of null (reading 'status')",
    file: 'src/app/services/api.service.ts',
    line: 7,
    fixSuggestion: 'return response?.status ?? 0',
    triggerLabel: 'Bug 3',
  },
  {
    id: 'bug-4',
    title: 'Bug 4: pipes/ — toLowerCase on null',
    description: 'SlugifyPipe.transform — value.toLowerCase when value null.',
    errorMessage: "TypeError: Cannot read properties of null (reading 'toLowerCase')",
    file: 'src/app/pipes/slugify.pipe.ts',
    line: 7,
    fixSuggestion: 'return value?.toLowerCase().replace(...) ?? ""',
    triggerLabel: 'Bug 4',
  },
  {
    id: 'bug-5',
    title: 'Bug 5: lib/ — toFixed on null',
    description: 'formatPercent in formatters — value.toFixed when value null.',
    errorMessage: "TypeError: Cannot read properties of null (reading 'toFixed')",
    file: 'src/app/lib/formatters.ts',
    line: 3,
    fixSuggestion: 'return value != null ? value.toFixed(2) + "%" : "0%"',
    triggerLabel: 'Bug 5',
  },
  {
    id: 'bug-6',
    title: 'Bug 6: guards/ — nested property on null',
    description: 'RoleGuard.getRoleLevel — user.role.level when user null.',
    errorMessage: "TypeError: Cannot read properties of null (reading 'role')",
    file: 'src/app/guards/role.guard.ts',
    line: 5,
    fixSuggestion: 'return user?.role?.level ?? 0',
    triggerLabel: 'Bug 6',
  },
  {
    id: 'bug-7',
    title: 'Bug 7: directives/ — trim on undefined',
    description: 'formatHighlight in highlight.helper — text.trim when undefined.',
    errorMessage: "TypeError: Cannot read properties of undefined (reading 'trim')",
    file: 'src/app/directives/highlight.helper.ts',
    line: 3,
    fixSuggestion: 'return text?.trim() ?? ""',
    triggerLabel: 'Bug 7',
  },
  {
    id: 'bug-8',
    title: 'Bug 8: components/ — find returns undefined',
    description: 'findItemName in search.helper — .name on undefined when id not found.',
    errorMessage: "TypeError: Cannot read properties of undefined (reading 'name')",
    file: 'src/app/components/search/search.helper.ts',
    line: 4,
    fixSuggestion: 'return items?.find(...)?.name ?? ""',
    triggerLabel: 'Bug 8',
  },
  {
    id: 'bug-9',
    title: 'Bug 9: services/ — JSON.parse on undefined',
    description: 'StorageService.getParsed — JSON.parse when key not in store.',
    errorMessage: 'SyntaxError: Unexpected token u in JSON',
    file: 'src/app/services/storage.service.ts',
    line: 9,
    fixSuggestion: 'const raw = this.store[key]; return raw ? JSON.parse(raw) : null',
    triggerLabel: 'Bug 9',
  },
  {
    id: 'bug-10',
    title: 'Bug 10: utils/ — RegExp invalid pattern',
    description: 'matchPattern in regex.utils — new RegExp("[") throws SyntaxError.',
    errorMessage: 'SyntaxError: Invalid regular expression',
    file: 'src/app/utils/regex.utils.ts',
    line: 3,
    fixSuggestion: 'try { return str.match(new RegExp(pattern)); } catch { return null }',
    triggerLabel: 'Bug 10',
  },
];
