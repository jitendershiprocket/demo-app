<div class="bugs-dashboard">
  <h2>ğŸ› Phoenix Bug Demo â€” 5 Errors for Sentry</h2>
  <p class="subtitle">
    Har button alag error trigger karta hai, Sentry mein log hota hai. Phoenix <code>--from-sentry</code> se fetch karke fix karega.
  </p>

  <div class="fetch-section">
    <div class="input-row">
      <label for="userIdInput">User ID (1,2=valid | 999=bug):</label>
      <input id="userIdInput" type="number" [(ngModel)]="inputId" min="1" placeholder="999" />
    </div>
    <div class="input-row">
      <label for="indexInput">Array index (0â€“1=valid | 5+=bug #3):</label>
      <input id="indexInput" type="number" [(ngModel)]="inputIndex" min="0" placeholder="5" />
    </div>
    <div class="buttons">
      <button type="button" (click)="triggerBug('bug-1')" [disabled]="loading">Bug #1: getUserId</button>
      <button type="button" (click)="triggerBug('bug-2')" [disabled]="loading">Bug #2: getUserEmail</button>
      <button type="button" (click)="triggerBug('bug-3')" [disabled]="loading">Bug #3: getNthUserName</button>
      <button type="button" (click)="triggerBug('bug-4')" [disabled]="loading">Bug #4: getDomainFromEmail</button>
      <button type="button" (click)="triggerBug('bug-5')" [disabled]="loading">Bug #5: getEmailLowercase</button>
    </div>
  </div>

  @if (result) {
  <div class="result-box" [class.error]="!result.success">
    @if (result.success) {
      <p class="success-msg">âœ… {{ result.label }} print hui: <strong>{{ result.value }}</strong></p>
      @if (result.value === 'User not found') {
        <p class="graceful-note">(Fix ke baad â€” graceful, crash nahi)</p>
      }
    } @else {
      <p class="error-msg">âŒ {{ result.label }} print nahi hui â€” bug ki wajah se:</p>
      <code>{{ result.value }}</code>
      <p class="fix-hint">Fix ke baad: "User not found" dikhega, crash nahi hoga.</p>
    }
  </div>
  }

  <div class="before-after">
    <h4>ğŸ“‹ Before Fix vs After Fix</h4>
    <div class="comparison">
      <div class="col">
        <strong>Abhi (Bug):</strong>
        <ul>
          <li>ID 1, 2 â†’ ID/Email print hoti hai âœ…</li>
          <li>ID 999 â†’ Crash, kuch print nahi hota âŒ</li>
        </ul>
      </div>
      <div class="col">
        <strong>Fix ke baad:</strong>
        <ul>
          <li>ID 1, 2 â†’ ID/Email print hoti hai âœ…</li>
          <li>ID 999 â†’ "User not found" (graceful) âœ…</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="bug-cards">
    <h4>Bug Details</h4>
    @for (bug of bugs; track bug.id) {
      <div class="bug-card">
        <span class="bug-id">{{ bug.id }}</span>
        <h3>{{ bug.title }}</h3>
        <p class="description">{{ bug.description }}</p>
        <div class="detail-row"><strong>Error:</strong> <code>{{ bug.errorMessage }}</code></div>
        <div class="detail-row"><strong>Fix:</strong> <code>{{ bug.fixSuggestion }}</code></div>
      </div>
    }
  </div>
</div>
